-#=stylesheet_link_tag "http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css"
-#=javascript_include_tag "http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"
=stylesheet_link_tag "leaflet/leaflet"
=javascript_include_tag "leaflet/leaflet"

:scss
  #map{
    height: 600px;
  }

#map

:javascript
    var markersLayer;
    var mymap = L.map('map').setView([48.5, 31.2], 6);

    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
        maxZoom: 16,
        id: 'quicks.0hf3cla6',
        accessToken: 'pk.eyJ1IjoicXVpY2tzIiwiYSI6ImNpcTE1Z2xyYzAwMm1pMm0ybXFoMW1hdzAifQ.NQB9Oj5QISGyxJ9FTvNK3Q'
    }).addTo(mymap);

    var geojsonMarkerOptions = {
      radius: 10,
      fillColor: "#ff7800",
      color: "#000",
      weight: 1,
      opacity: 1,
      fillOpacity: 0.8
    };

    function onEachFeature(feature, layer) {
      if (feature.properties && feature.properties.title) {
            layer.bindPopup(feature.properties.title);
      }
    }
    function addMarkers(markers) {
      markersLayer = L.geoJson(markers, {
           onEachFeature: onEachFeature,
          pointToLayer: function (feature, latlng) {
          return L.circleMarker(latlng, geojsonMarkerOptions);
        }
      });

      mymap.addLayer(markersLayer);
    }

  $(document).ready(function(){
    $.ajax({
      url : '/geo_json_tender',
      dataType: 'JSON',
      success: function(data) {
        addMarkers(data);
       }
    })
  });

